% From test_suite/N2 
V=[9.0399D-01  -4.3829D+04
   1.0170D+00  -7.4959D+04
   1.1300D+00  -7.8971D+04
   1.2430D+00  -7.0759D+04
   1.3560D+00  -5.8161D+04
   1.4690D+00  -4.4962D+04
   1.5820D+00  -3.2798D+04
   1.6950D+00  -2.2540D+04
   1.8080D+00  -1.4466D+04
   1.9210e+00  -7.7277e+03
   2.0339e+00  -4.0844e+03
   2.1470e+00  -2.3045e+03
   2.2600e+00  -1.2313e+03
   2.3729e+00  -6.8037e+02
   2.4860e+00  -4.0822e+02
   2.5989e+00  -2.9190e+02
   2.7119e+00  -2.0631e+02]
r=V(:,1);
V=V(:,2);

De=79845.0;
Re=1.097679d0;
Vmin=-79845.0;

p=3;
x=(r.^p- Re.^p)./(r.^p + Re.^p)

X = [x.^0 x.^1 x.^2 x.^3 x.^4 x.^5 x.^6]

%y = log(1-sqrt((V-Vmin)./De))./(Re-r);
y = log(1+sqrt((V-Vmin)./De))./(Re-r);

beta=X\y
residual=y-X*beta

V_reproduced=De*(1 - exp(-X*beta)).^2 + Vmin;
plot(r,V_reproduced)
